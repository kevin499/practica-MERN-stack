<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Desafio 9</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    </head>
    
<body>
    <h1 class="mb-5 text-primary">Ingrese producto</h1>

<form id="form" class="px-2">
    <label for="nombre" class="form-label text-strong">
        <strong><i>Nombre</i></strong>
    </label>
    <input type="text" name="title" class="form-control" id="nombre">

    <label for="precio" class="form-label text-strong">
        <strong><i>Precio</i></strong>
    </label>
    <input type="text" name="price" class="form-control" id="precio">

    <label for="foto_url" class="form-label text-strong">
        <strong><i>Foto URL</i></strong>
    </label>
    <input type="text" name="thumbnail" class="form-control" id="foto_url">

    <button class="btn btn-success mt-5">Enviar</button>
</form>

<script>
    const form = document.getElementById("form")

    form.addEventListener("submit", (e) => {
        e.preventDefault()

        const formData = new FormData(form);

        let json = {};
        formData.forEach((value, key) => { json[key] = value });

        fetch('/api/productos', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(json),
        })
            .then(response => response.json())
            .then(function (json) {
                if (json.status == "ok") {
                    location.href = "index.html";
                }
            })
            .catch(function (err) {
                console.log(err);
            });
    })
</script>
</body>
</html>